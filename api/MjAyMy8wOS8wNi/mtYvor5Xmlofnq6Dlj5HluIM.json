{"title":"测试文章发布","date":"2023-09-06T10:32:26.000Z","date_formatted":{"ll":"2023年9月6日","L":"2023/09/06","MM-DD":"09-06"},"link":"2023/09/06/测试文章发布","tags":["文"],"categories":["栏目一"],"updated":"2023-09-06T12:34:36.362Z","content":"<h1 id=\"20230906\">20230906<a title=\"#20230906\" href=\"#20230906\"></a></h1>\n<h2 id=\"早上工作\">早上工作<a title=\"#早上工作\" href=\"#早上工作\"></a></h2>\n<ol>\n<li>扯淡</li>\n<li>打屁</li>\n</ol>\n<h2 id=\"下午工作\">下午工作<a title=\"#下午工作\" href=\"#下午工作\"></a></h2>\n<ol>\n<li>摸鱼</li>\n<li>干活</li>\n</ol>\n<h1 id=\"202309101\">202309101<a title=\"#202309101\" href=\"#202309101\"></a></h1>\n<h2 id=\"早上工作太多了\">早上工作太多了<a title=\"#早上工作太多了\" href=\"#早上工作太多了\"></a></h2>\n<ol>\n<li>待定</li>\n</ol>\n<h2 id=\"下午工作-1\">下午工作<a title=\"#下午工作-1\" href=\"#下午工作-1\"></a></h2>\n<ol>\n<li>待定</li>\n</ol>\n<h1 id=\"20230907\">20230907<a title=\"#20230907\" href=\"#20230907\"></a></h1>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># -*- coding:utf-8 -*-</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> time</span><br><span class=\"line\"><span class=\"keyword\">from</span> autoTest.constant.template <span class=\"keyword\">import</span> protocol_change_para, modename</span><br><span class=\"line\"><span class=\"keyword\">from</span> autoTest.testflow.tools.shoptool <span class=\"keyword\">import</span> creatmendian</span><br><span class=\"line\"><span class=\"keyword\">from</span> autoTest.testcase.protocol <span class=\"keyword\">import</span> createtemplate, createprotocol, protocolcompare</span><br><span class=\"line\"><span class=\"keyword\">from</span> autoTest.testatom.common.utilfuncs <span class=\"keyword\">import</span> writelog</span><br><span class=\"line\"><span class=\"keyword\">from</span> autoTest.testatom.legalchain.aggrement <span class=\"keyword\">import</span> isContractGenerated, getContractNo, getApprovalNo, getFinalContractNo</span><br><span class=\"line\"><span class=\"keyword\">import</span> pytest</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">&quot;&quot;&quot;</span></span><br><span class=\"line\"><span class=\"string\">法务链 IO 协议生成对比自动化</span></span><br><span class=\"line\"><span class=\"string\">&quot;&quot;&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@pytest.mark.parametrize(<span class=\"params\"><span class=\"string\">&quot;mode&quot;</span>, modename</span>)</span></span><br><span class=\"line\"><span class=\"meta\">@pytest.mark.flaky(<span class=\"params\">reruns=<span class=\"number\">3</span>, reruns_delay=<span class=\"number\">5</span></span>)  </span><span class=\"comment\"># 用例若运行失败，5秒后重试，重试3次</span></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">test_agreement</span>(<span class=\"params\">mode</span>):</span><br><span class=\"line\">    user = <span class=\"string\">&#x27;邓微（Kristy ）&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># 创建门店</span></span><br><span class=\"line\">    newShop_detail = creatmendian(user, mode)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># drcnolist 要作为列表传入，组装在这里</span></span><br><span class=\"line\">    drcnolist = []</span><br><span class=\"line\">    drcnolist.append(newShop_detail[<span class=\"string\">&quot;drcNo&quot;</span>])</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># 创建协议模板</span></span><br><span class=\"line\">    template_name, template_id = createtemplate(user, mode, <span class=\"string\">&#x27;IO&#x27;</span>, <span class=\"number\">7706</span>)</span><br><span class=\"line\">    <span class=\"comment\"># 创建协议</span></span><br><span class=\"line\">    batchNo = createprotocol(user, <span class=\"number\">7706</span>, drcnolist, template_id, mode)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># 组装要替换的数据</span></span><br><span class=\"line\">    protocol_change_para[<span class=\"string\">&quot;门店企业名称&quot;</span>] = newShop_detail[<span class=\"string\">&#x27;entName&#x27;</span>]</span><br><span class=\"line\">    protocol_change_para[<span class=\"string\">&quot;乙方统一社会信用代码&quot;</span>] = newShop_detail[<span class=\"string\">&#x27;partyBCreditCode&#x27;</span>]</span><br><span class=\"line\">    protocol_change_para[<span class=\"string\">&quot;店铺地址&quot;</span>] = newShop_detail[<span class=\"string\">&#x27;shopAddress&#x27;</span>]</span><br><span class=\"line\">    protocol_change_para[<span class=\"string\">&quot;乙方户名&quot;</span>] = newShop_detail[<span class=\"string\">&#x27;partyBName&#x27;</span>]</span><br><span class=\"line\">    protocol_change_para[<span class=\"string\">&quot;申请书编号&quot;</span>] = getContractNo(<span class=\"number\">7706</span>)</span><br><span class=\"line\">    protocol_change_para[<span class=\"string\">&quot;核准书编号&quot;</span>] = getApprovalNo(<span class=\"number\">7706</span>)</span><br><span class=\"line\">    <span class=\"comment\"># 这里要等待后再获取才能拿到值</span></span><br><span class=\"line\">    time.sleep(<span class=\"number\">10</span>)</span><br><span class=\"line\">    protocol_change_para[<span class=\"string\">&quot;合同编号&quot;</span>] = getFinalContractNo(newShop_detail[<span class=\"string\">&#x27;task_inst_id&#x27;</span>])</span><br><span class=\"line\">    writelog.info(<span class=\"string\">&quot;__DEBUG__:合同编号为&#123;&#125;&quot;</span>.<span class=\"built_in\">format</span>(protocol_change_para[<span class=\"string\">&quot;合同编号&quot;</span>]))</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># 比较前要先下载协议，下载协议前先判断协议生成状态，若连续三次都未生成，则停止后续操作</span></span><br><span class=\"line\">    stopcount = <span class=\"number\">3</span></span><br><span class=\"line\">    <span class=\"keyword\">while</span> stopcount &gt;= <span class=\"number\">0</span>:</span><br><span class=\"line\">        <span class=\"keyword\">if</span> isContractGenerated(newShop_detail[<span class=\"string\">&quot;mguId&quot;</span>], batchNo):</span><br><span class=\"line\">            <span class=\"keyword\">assert</span> (protocolcompare(user, newShop_detail[<span class=\"string\">&quot;mguId&quot;</span>], batchNo, mode))[<span class=\"number\">0</span>] == <span class=\"literal\">True</span></span><br><span class=\"line\">            <span class=\"keyword\">return</span></span><br><span class=\"line\">        <span class=\"keyword\">else</span>:</span><br><span class=\"line\">            time.sleep(<span class=\"number\">3</span>)</span><br><span class=\"line\">            stopcount -= <span class=\"number\">1</span></span><br><span class=\"line\">    writelog.error(<span class=\"string\">&quot;批量生成协议等待 10s 后仍未成功，请查看状态。 batch_no=&#123;&#125;&quot;</span>.<span class=\"built_in\">format</span>(batchNo))</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> __name__ == <span class=\"string\">&quot;__main__&quot;</span>:</span><br><span class=\"line\">    test_agreement()</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h1 id=\"20230911\">20230911<a title=\"#20230911\" href=\"#20230911\"></a></h1>\n<p>图片示例</p>\n<p><img src=\"C:%5CUsers%5Cwangxuchao%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20230906194344418.png\" alt=\"image-20230906194344418\" loading=\"lazy\" class=\"φbp\"></p>\n","plink":"http://example.com/2023/09/06/测试文章发布/","copyright":{"author":"Saitolers","link":"<a href=\"http://example.com/2023/09/06/测试文章发布/\" title=\"测试文章发布\">http://example.com/2023/09/06/测试文章发布/</a>","license":"自由转载-非商用-禁止演绎-保持署名(<a href=\\\"https://creativecommons.org/licenses/by-nc-sa/4.0/\\\" rel=\\\"external nofollow\\\" target=\\\"_blank\\\">CC BY-NC-ND 4.0</a>)"},"reading_time":"457 字约 3 分钟"}